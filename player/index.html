<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <style>
        body, html{
            background-color:#fff;
            margin: 0px;
            height: 100%;
            overflow-x: hidden;
            overflow-y: auto;
        }

        #content{
            position: relative;
            background-color:#ccc;
            width:360px;
            height:640px;
            display:block;
            overflow: hidden;
            transform: translate3d(0,0,0);
            margin: 30px auto;
            /*display:none;*/
        }
        #edit{
            position: absolute;
            width: 0;
            height: 0;
            border: 1px dashed #333333;
            display: block;
        }
        #tools{
            width: 500px;
            height: 20px;
            margin: 0 auto;
        }
        #fr-txt{
            font-size: 18px;
        }
    </style>
    <!-- build:js lottie.js -->
    <script src="js/main.js"></script>
    <script src="js/utils/common.js"></script>
    <script src="js/utils/BaseEvent.js"></script>
    <script src="js/utils/helpers/arrays.js"></script>
    <script src="js/utils/helpers/svg_elements.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/utils/helpers/html_elements.js"></script>
    <script src="js/utils/helpers/dynamicProperties.js"></script>
    <script src="js/utils/helpers/blendModes.js"></script>
    <script src="js/3rd_party/transformation-matrix.js"></script>
    <script src="js/3rd_party/seedrandom.js"></script>
    <script src="js/3rd_party/BezierEaser.js"></script>
    <script src="js/utils/animationFramePolyFill.js"></script>
    <script src="js/utils/functionExtensions.js"></script>
    <script src="js/utils/bez.js"></script>
    <script src="js/utils/DataManager.js"></script>
    <!-- <script src="js/utils/DataManagerWorkerOverrides.js" data-builds="canvas_worker"></script> -->
    <script src="js/utils/FontManager.js"></script>
    <!-- <script src="js/utils/FontManagerWorkerOverride.js" data-builds="canvas_worker"></script> -->
    <script src="js/utils/PropertyFactory.js"></script>
    <script src="js/utils/TransformProperty.js"></script>
    <script src="js/utils/shapes/ShapePath.js"></script>
    <script src="js/utils/shapes/ShapeProperty.js"></script>
    <script src="js/utils/shapes/ShapeModifiers.js"></script>
    <script src="js/utils/shapes/TrimModifier.js"></script>
    <script src="js/utils/shapes/RoundCornersModifier.js"></script>
    <script src="js/utils/shapes/RepeaterModifier.js"></script>
    <script src="js/utils/shapes/ShapeCollection.js"></script>
    <script src="js/utils/shapes/DashProperty.js"></script>
    <script src="js/utils/shapes/GradientProperty.js"></script>
    <script src="js/utils/shapes/shapePathBuilder.js"></script>
    <script src="js/utils/imagePreloader.js" data-builds="full,canvas,canvas_light,html,html_light,svg,svg_light"></script>
    <!-- <script src="js/utils/imagePreloaderWorkerOverride.js" data-builds="canvas_worker"></script> -->
    <script src="js/utils/featureSupport.js"></script>
    <script src="js/utils/filters.js"></script>
    <script src="js/utils/asset_loader.js"></script>
    <!-- <script src="js/utils/asset_loader_worker_override.js" data-builds="canvas_worker"></script> -->
    <script src="js/utils/text/TextAnimatorProperty.js"></script>
    <script src="js/utils/text/TextAnimatorDataProperty.js"></script>
    <script src="js/utils/text/LetterProps.js"></script>
    <script src="js/utils/text/TextProperty.js"></script>
    <script src="js/utils/text/TextSelectorProperty.js"></script>
    <script src="js/utils/pooling/pool_factory.js"></script>
    <script src="js/utils/pooling/pooling.js"></script>
    <script src="js/utils/pooling/point_pool.js"></script>
    <script src="js/utils/pooling/shape_pool.js"></script>
    <script src="js/utils/pooling/shapeCollection_pool.js"></script>
    <script src="js/utils/pooling/segments_length_pool.js"></script>
    <script src="js/utils/pooling/bezier_length_pool.js"></script>
    <script src="js/renderers/BaseRenderer.js"></script>
    <script src="js/renderers/SVGRenderer.js"></script>
    <script src="js/renderers/CanvasRenderer.js" data-builds="full,canvas,canvas_light,canvas_worker"></script>
    <!-- <script src="js/renderers/CanvasRendererWorkerOverride.js" data-builds="canvas_worker"></script> -->
<!--    <script src="js/renderers/HybridRenderer.js" data-builds="full,html,html_light"></script>-->
    <script src="js/mask.js"></script>
    <script src="js/elements/helpers/HierarchyElement.js"></script>
    <script src="js/elements/helpers/FrameElement.js"></script>
    <script src="js/elements/helpers/TransformElement.js"></script>
    <script src="js/elements/helpers/RenderableElement.js"></script>
    <script src="js/elements/helpers/RenderableDOMElement.js"></script>
    <script src="js/elements/helpers/shapes/ProcessedElement.js"></script>
    <script src="js/elements/helpers/shapes/SVGStyleData.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/helpers/shapes/SVGShapeData.js" ></script>
    <script src="js/elements/helpers/shapes/SVGTransformData.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/helpers/shapes/SVGStrokeStyleData.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/helpers/shapes/SVGFillStyleData.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/helpers/shapes/SVGGradientFillStyleData.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/helpers/shapes/SVGGradientStrokeStyleData.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/helpers/shapes/ShapeGroupData.js"></script>
    <script src="js/elements/helpers/shapes/SVGElementsRenderer.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/helpers/shapes/ShapeTransformManager.js"></script>
    <script src="js/elements/BaseElement.js"></script>
    <script src="js/elements/NullElement.js"></script>
    <script src="js/elements/svgElements/SVGBaseElement.js"></script>
    <script src="js/elements/ShapeElement.js"></script>
    <script src="js/elements/TextElement.js"></script>
    <script src="js/elements/CompElement.js"></script>
    <script src="js/elements/ImageElement.js"></script>
    <script src="js/elements/SolidElement.js"></script>
    <script src="js/elements/svgElements/SVGCompElement.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/SVGTextElement.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/SVGShapeElement.js"></script>
    <script src="js/elements/svgElements/effects/SVGTintEffect.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/effects/SVGFillFilter.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/effects/SVGGaussianBlurEffect.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/effects/SVGStrokeEffect.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/effects/SVGTritoneFilter.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/effects/SVGProLevelsFilter.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/effects/SVGDropShadowEffect.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/effects/SVGMatte3Effect.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/elements/svgElements/SVGEffects.js" data-builds="full,svg,svg_light,html,html_light"></script>
    <script src="js/animation/AnimationManager.js"></script>
    <!-- <script src="js/animation/AnimationManagerWorkerOverride.js" data-builds="canvas_worker"></script> -->
    <script src="js/animation/AnimationItem.js"></script>
    <!-- <script src="js/animation/AnimationItemWorkerOverride.js" data-builds="canvas_worker"></script> -->
    <!-- Expressions -->
    <script src="js/utils/expressions/Expressions.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/ExpressionManager.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/expressionHelpers.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/ExpressionPropertyDecorator.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/ExpressionTextPropertyDecorator.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/ShapeInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/TextInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/LayerInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/CompInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/TransformInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/ProjectInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/EffectInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/MaskInterface.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/ExpressionValueFactory.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/utils/expressions/TextSelectorPropertyDecorator.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/effects/SliderEffect.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <script src="js/effects/EffectsManagerPlaceholder.js" ></script>
    <script src="js/EffectsManager.js" data-builds="full,svg,canvas,html,canvas_worker"></script>
    <!-- end Expressions -->
    <!-- endbuild -->
    <script src="js/module.js" ></script>
     <script src="lottie_api.js"></script>
    <!-- <script src="bodymovin_light.js"></script> -->



</head>
<body>

<div id="content">
    <div id="lottie"></div>
    <div id="edit"></div>
</div>

<div id="tools">
    <form>
        <input id="scroll" max="288" min="0"  value="0" type="range" >
    </form>
    <span id="fr-txt">0</span>
    <button id="btn">点击触发</button>
</div>
<script>
    var anim;
    var elem = document.getElementById('lottie');

    var animData = {
        container: elem,
        renderer: 'svg',
        loop: false,
        autoplay: false,
        rendererSettings: {
            progressiveLoad:false,
            preserveAspectRatio: 'xMidYMid meet',
            imagePreserveAspectRatio: 'xMidYMid meet',
            id:"svgg"
        },
        path: './data/data.json'
    };
    // lottie.setQuality('low');
    window.anim = anim = lottie.loadAnimation(animData);
    // anim.goToAndStop(100,true);
    document.getElementById("scroll").addEventListener("change",(e)=>{
        let value = e.target.value;
        console.log(value)
        anim.goToAndStop(parseInt(value),true);
        document.getElementById('fr-txt').innerText = value;
    })
    let editorBox = document.getElementById('edit');
    let lottieBox = document.getElementById('lottie');
    let boxRect = lottieBox.getBoundingClientRect();
    lottieBox.addEventListener('click',(e)=>{
        console.log(e);
        let eleTar = e.target.parentElement.parentElement;
        console.log(eleTar.getAttribute("class"))
        if(eleTar && eleTar.getAttribute("class").indexOf("comp")>-1){
            let rect = eleTar.getBoundingClientRect();
            let bbox = eleTar.getBBox();
            console.log(rect,bbox)
            editorBox.style.width = rect.width  + "px";
            editorBox.style.height = rect.height + "px";
            editorBox.style.top = (rect.y - boxRect.y) + "px";
            editorBox.style.left = (rect.x - boxRect.x) + "px";
            editorBox.style.display = "block";
        }else{
            editorBox.style.display = "none";
        }
    })


    document.getElementById("btn").addEventListener("click",(e)=>{
        console.log(anim)
      anim.animationData.assets[14].layers[0].t.d.k[0].s.t="过\r年\r好";
      anim.renderer.globalData.changedTags=['comp_0-1'];
      anim.renderer.globalData.changedValue={"comp_0-1":{t:"过\r年\r好"}};
        // anim.updateData({'comp_0-1':1})
      anim.renderer.renderFrame(2,true);
      anim.renderer.globalData.changedTags =[];
      anim.renderer.globalData.changedValue={};

    })
    anim.onError = function(errorType, nativeError, errorProps) {
        console.log(errorType)
    }

    anim.addEventListener('error', function(error) {
        console.log(error)
    })
</script>

</body>
</html>
